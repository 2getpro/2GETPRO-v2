# Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ñ 2GETPRO v1 Ð½Ð° v2

## ÐžÐ³Ð»Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ

1. [ÐžÐ±Ð·Ð¾Ñ€ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸](#Ð¾Ð±Ð·Ð¾Ñ€-Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸)
2. [ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸](#Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ°-Ðº-Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸)
3. [Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ v1](#Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ-ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ-v1)
4. [ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…](#Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ñ-Ð±Ð°Ð·Ñ‹-Ð´Ð°Ð½Ð½Ñ‹Ñ…)
5. [ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸](#Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ñ-ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸)
6. [Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ v2](#Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ-v2)
7. [ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°](#Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ-Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°)
8. [ÐžÑ‚ÐºÐ°Ñ‚ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸](#Ð¾Ñ‚ÐºÐ°Ñ‚-Ð¿Ñ€Ð¸-Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸)
9. [ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸](#Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°-Ð¿Ð¾ÑÐ»Ðµ-Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸)

---

## ÐžÐ±Ð·Ð¾Ñ€ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

### Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ **Blue-Green Deployment** ÑÑ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ:
- v1 (Blue) Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÑ‚ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ
- v2 (Green) Ñ€Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾
- ÐŸÐ¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°: 10% â†’ 50% â†’ 100%
- v1 Ð¾ÑÑ‚Ð°ÐµÑ‚ÑÑ Ð² standby 24 Ñ‡Ð°ÑÐ° Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¾Ñ‚ÐºÐ°Ñ‚Ð°

### Ð’Ñ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ ÑˆÐºÐ°Ð»Ð°

| Ð­Ñ‚Ð°Ð¿ | Ð”Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|--------------|----------|
| ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° | 2-4 Ñ‡Ð°ÑÐ° | Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ |
| Ð Ð°Ð·Ð²ÐµÑ€Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ðµ v2 | 1-2 Ñ‡Ð°ÑÐ° | Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° v2 |
| ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð‘Ð” | 30-60 Ð¼Ð¸Ð½ÑƒÑ‚ | ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ ÑÑ…ÐµÐ¼Ñ‹ |
| Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ | 2-4 Ñ‡Ð°ÑÐ° | Smoke testing, UAT |
| ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ 10% | 1 Ñ‡Ð°Ñ | ÐŸÐµÑ€Ð²Ð°Ñ Ð²Ð¾Ð»Ð½Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ |
| ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ 10% | 4-8 Ñ‡Ð°ÑÐ¾Ð² | ÐÐ°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð·Ð° Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼Ð¸ |
| ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ 50% | 1 Ñ‡Ð°Ñ | Ð’Ñ‚Ð¾Ñ€Ð°Ñ Ð²Ð¾Ð»Ð½Ð° |
| ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ 50% | 4-8 Ñ‡Ð°ÑÐ¾Ð² | ÐÐ°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ðµ Ð·Ð° Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ°Ð¼Ð¸ |
| ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ 100% | 1 Ñ‡Ð°Ñ | ÐŸÐ¾Ð»Ð½Ð¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ |
| Standby Ð¿ÐµÑ€Ð¸Ð¾Ð´ | 24 Ñ‡Ð°ÑÐ° | v1 Ð³Ð¾Ñ‚Ð¾Ð² Ðº Ð¾Ñ‚ÐºÐ°Ñ‚Ñƒ |
| **ÐžÐ±Ñ‰ÐµÐµ Ð²Ñ€ÐµÐ¼Ñ** | **2-3 Ð´Ð½Ñ** | Ð¡ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° |

### Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ

**Ð¢ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ:**
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº ÑÐµÑ€Ð²ÐµÑ€Ð°Ð¼ v1 Ð¸ v2
- ÐŸÑ€Ð°Ð²Ð° Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€Ð° Ð‘Ð”
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº DNS Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ð¼
- Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº Telegram Bot API

**ÐšÐ¾Ð¼Ð°Ð½Ð´Ð°:**
- Backend Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº
- DevOps Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€
- QA Ð¸Ð½Ð¶ÐµÐ½ÐµÑ€
- Ð”ÐµÐ¶ÑƒÑ€Ð½Ñ‹Ð¹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€

---

## ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ðº Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

### 1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð³Ð¾Ñ‚Ð¾Ð²Ð½Ð¾ÑÑ‚Ð¸ v2

**Ð§ÐµÐºÐ»Ð¸ÑÑ‚:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
cd 2GETPRO_v2
cat .env.production

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹
pip list | grep -E "aiogram|sqlalchemy|redis|prometheus"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Ð‘Ð”
psql -h $DB_HOST -U $DB_USER -d $DB_NAME -c "SELECT version();"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ Ðº Redis
redis-cli -h $REDIS_HOST ping

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Telegram Bot API
curl https://api.telegram.org/bot$BOT_TOKEN/getMe
```

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** Ð’ÑÐµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð¿Ñ€Ð¾Ð¹Ñ‚Ð¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ âœ…

### 2. Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹

**Ð—Ð° 48 Ñ‡Ð°ÑÐ¾Ð²:**
```python
# ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ðµ Ð²ÑÐµÐ¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼
await bot.send_message(
    chat_id=user.telegram_id,
    text=(
        "ðŸ”„ Ð£Ð²Ð°Ð¶Ð°ÐµÐ¼Ñ‹Ðµ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ð¸!\n\n"
        "27 Ð½Ð¾ÑÐ±Ñ€Ñ Ñ 03:00 Ð´Ð¾ 05:00 ÐœÐ¡Ðš Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¾Ð²ÐµÐ´ÐµÐ½Ð¾ Ð¿Ð»Ð°Ð½Ð¾Ð²Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.\n"
        "Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹ ÐºÑ€Ð°Ñ‚ÐºÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÑ€Ñ‹Ð²Ñ‹ Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ðµ.\n\n"
        "ÐŸÑ€Ð¸Ð½Ð¾ÑÐ¸Ð¼ Ð¸Ð·Ð²Ð¸Ð½ÐµÐ½Ð¸Ñ Ð·Ð° Ð½ÐµÑƒÐ´Ð¾Ð±ÑÑ‚Ð²Ð°."
    )
)
```

**Ð—Ð° 2 Ñ‡Ð°ÑÐ°:**
```python
await bot.send_message(
    chat_id=user.telegram_id,
    text=(
        "âš ï¸ Ð§ÐµÑ€ÐµÐ· 2 Ñ‡Ð°ÑÐ° Ð½Ð°Ñ‡Ð½ÐµÑ‚ÑÑ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.\n"
        "Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÐ¼ Ð·Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ Ð²ÑÐµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸."
    )
)
```

### 3. ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¹:**
```bash
# Ð”Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ Ð´Ð»Ñ Ð±ÑÐºÐ°Ð¿Ð¾Ð²
sudo mkdir -p /backup/2getpro/{v1,v2}
sudo mkdir -p /backup/2getpro/postgres
sudo mkdir -p /backup/2getpro/redis
sudo mkdir -p /backup/2getpro/configs

# ÐŸÑ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
sudo chown -R $USER:$USER /backup/2getpro
chmod 700 /backup/2getpro
```

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð¼ÐµÑÑ‚Ð°:**
```bash
# ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ 50GB Ð´Ð»Ñ Ð±ÑÐºÐ°Ð¿Ð¾Ð²
df -h /backup

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ð‘Ð”
psql -h $DB_HOST -U $DB_USER -d $DB_NAME -c "
SELECT pg_size_pretty(pg_database_size('$DB_NAME'));
"
```

---

## Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ v1

### 1. ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ñ„Ð¾Ð½Ð¾Ð²Ñ‹Ñ… Ð·Ð°Ð´Ð°Ñ‡

```bash
# ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ cron Ð·Ð°Ð´Ð°Ñ‡Ð¸
sudo systemctl stop cron

# Ð˜Ð»Ð¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ñ‡Ð¸
crontab -e
# Ð—Ð°ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ 2GETPRO

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹
ps aux | grep 2getpro
```

### 2. Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ PostgreSQL

**ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð±ÑÐºÐ°Ð¿:**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð´Ð°Ð¼Ð¿ Ð‘Ð”
pg_dump -h $DB_HOST -U $DB_USER -d 2getpro_v1 \
  -F c -Z 9 \
  -f /backup/2getpro/v1/db_backup_$(date +%Y%m%d_%H%M%S).dump

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ€Ð°Ð·Ð¼ÐµÑ€
ls -lh /backup/2getpro/v1/

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ
pg_restore --list /backup/2getpro/v1/db_backup_*.dump | head -20
```

**Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² SQL (Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸):**
```bash
pg_dump -h $DB_HOST -U $DB_USER -d 2getpro_v1 \
  --clean --if-exists \
  -f /backup/2getpro/v1/db_backup_$(date +%Y%m%d_%H%M%S).sql
```

### 3. Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Redis

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ snapshot
redis-cli -h $REDIS_HOST BGSAVE

# Ð”Ð¾Ð¶Ð´Ð°Ñ‚ÑŒÑÑ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ
redis-cli -h $REDIS_HOST LASTSAVE

# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ RDB Ñ„Ð°Ð¹Ð»
docker cp 2getpro-redis:/data/dump.rdb \
  /backup/2getpro/redis/dump_$(date +%Y%m%d_%H%M%S).rdb
```

### 4. Ð ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸

```bash
# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ .env Ñ„Ð°Ð¹Ð»
cp /opt/2getpro_v1/.env /backup/2getpro/configs/env_v1_$(date +%Y%m%d_%H%M%S)

# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ docker-compose.yml
cp /opt/2getpro_v1/docker-compose.yml /backup/2getpro/configs/

# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ nginx ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo cp /etc/nginx/sites-available/2getpro \
  /backup/2getpro/configs/nginx_v1_$(date +%Y%m%d_%H%M%S)
```

### 5. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð°Ñ€Ñ…Ð¸Ð²Ð°

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ tar.gz Ð°Ñ€Ñ…Ð¸Ð² Ð²ÑÐµÑ… Ð±ÑÐºÐ°Ð¿Ð¾Ð²
cd /backup/2getpro
tar -czf v1_full_backup_$(date +%Y%m%d_%H%M%S).tar.gz v1/ postgres/ redis/ configs/

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð°Ñ€Ñ…Ð¸Ð²
tar -tzf v1_full_backup_*.tar.gz | head -20

# Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð² S3 (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
aws s3 cp v1_full_backup_*.tar.gz s3://2getpro-backups/migrations/
```

---

## ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

### 1. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ð¾Ð¹ Ð‘Ð” Ð´Ð»Ñ v2

```bash
# ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒÑÑ Ðº PostgreSQL
psql -h $DB_HOST -U postgres

# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²ÑƒÑŽ Ð‘Ð”
CREATE DATABASE 2getpro_v2 OWNER 2getpro_user;

# Ð’Ñ‹Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð°
GRANT ALL PRIVILEGES ON DATABASE 2getpro_v2 TO 2getpro_user;

# Ð’Ñ‹Ð¹Ñ‚Ð¸
\q
```

### 2. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· v1

```bash
# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð´Ð°Ð¼Ð¿ Ð² Ð½Ð¾Ð²ÑƒÑŽ Ð‘Ð”
pg_restore -h $DB_HOST -U $DB_USER \
  -d 2getpro_v2 \
  --clean --if-exists \
  /backup/2getpro/v1/db_backup_*.dump

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹
psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -c "
SELECT 
  'users' as table_name, COUNT(*) as count FROM users
UNION ALL
SELECT 'subscriptions', COUNT(*) FROM subscriptions
UNION ALL
SELECT 'payments', COUNT(*) FROM payments;
"
```

### 3. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹ v2

```bash
cd /opt/2getpro_v2

# ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸
alembic upgrade head

# Ð˜Ð»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ð¹ Ð¼Ð¸Ð³Ñ€Ð°Ñ‚Ð¾Ñ€
python -m db.migrator upgrade

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð²ÐµÑ€ÑÐ¸ÑŽ ÑÑ…ÐµÐ¼Ñ‹
alembic current
```

### 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ†ÐµÐ»Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…

```sql
-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
SELECT COUNT(*) as total_users,
       COUNT(CASE WHEN status = 'active' THEN 1 END) as active_users,
       COUNT(CASE WHEN status = 'blocked' THEN 1 END) as blocked_users
FROM users;

-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¾Ðº
SELECT COUNT(*) as total_subscriptions,
       COUNT(CASE WHEN status = 'active' THEN 1 END) as active_subs,
       COUNT(CASE WHEN is_trial = true THEN 1 END) as trial_subs
FROM subscriptions;

-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð»Ð°Ñ‚ÐµÐ¶ÐµÐ¹
SELECT payment_method,
       COUNT(*) as count,
       SUM(amount_kopeks) as total_amount
FROM payments
WHERE status = 'succeeded'
GROUP BY payment_method;

-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð¾Ð²
SELECT type,
       COUNT(*) as count,
       SUM(current_uses) as total_uses
FROM promo_codes
GROUP BY type;
```

### 5. Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð² (ÐµÑÐ»Ð¸ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸ÑÐ¼Ð¸)

```sql
-- ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹
\i /opt/2getpro_v2/db/optimization/indexes.sql

-- ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹
SELECT schemaname, tablename, indexname, indexdef
FROM pg_indexes
WHERE schemaname = 'public'
ORDER BY tablename, indexname;
```

---

## ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸

### 1. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

```bash
# Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð¼ÐµÑ€
cp /opt/2getpro_v2/.env.example /opt/2getpro_v2/.env.production

# ÐŸÐµÑ€ÐµÐ½ÐµÑÑ‚Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¸Ð· v1
cat /backup/2getpro/configs/env_v1_* | grep -E "BOT_TOKEN|ADMIN_IDS|PANEL_API" \
  >> /opt/2getpro_v2/.env.production

# Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ v2
cat >> /opt/2getpro_v2/.env.production << EOF
# Monitoring
PROMETHEUS_ENABLED=true
SENTRY_DSN=your_sentry_dsn
GRAFANA_URL=http://localhost:3000

# Security
RATE_LIMIT_ENABLED=true
WEBHOOK_VALIDATION_ENABLED=true

# Performance
REDIS_CACHE_ENABLED=true
REDIS_URL=redis://localhost:6379/0

# Backup
BACKUP_ENABLED=true
BACKUP_S3_BUCKET=2getpro-backups
EOF

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð°
chmod 600 /opt/2getpro_v2/.env.production
```

### 2. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Nginx

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ Ð´Ð»Ñ v2
sudo tee /etc/nginx/sites-available/2getpro-v2 << 'EOF'
upstream 2getpro_v1 {
    server 127.0.0.1:8001;
}

upstream 2getpro_v2 {
    server 127.0.0.1:8002;
}

# Split configuration Ð´Ð»Ñ Ð¿Ð¾ÑÑ‚ÐµÐ¿ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
split_clients "${remote_addr}" $backend {
    10%     2getpro_v2;  # 10% Ð½Ð° v2
    *       2getpro_v1;  # 90% Ð½Ð° v1
}

server {
    listen 443 ssl http2;
    server_name webhook.2getpro.com;

    ssl_certificate /etc/letsencrypt/live/webhook.2getpro.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/webhook.2getpro.com/privkey.pem;

    location / {
        proxy_pass http://$backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
EOF

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo nginx -t

# ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ (Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼)
sudo ln -s /etc/nginx/sites-available/2getpro-v2 /etc/nginx/sites-enabled/
```

### 3. ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Kubernetes (ÐµÑÐ»Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ)

```bash
# ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¼Ð°Ð½Ð¸Ñ„ÐµÑÑ‚Ñ‹ v2
kubectl apply -f /opt/2getpro_v2/infrastructure/kubernetes/namespace.yaml
kubectl apply -f /opt/2getpro_v2/infrastructure/kubernetes/configmap.yaml
kubectl apply -f /opt/2getpro_v2/infrastructure/kubernetes/secrets.yaml
kubectl apply -f /opt/2getpro_v2/infrastructure/kubernetes/deployment.yaml
kubectl apply -f /opt/2getpro_v2/infrastructure/kubernetes/service.yaml

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚ÑƒÑ
kubectl get pods -n 2getpro-v2
kubectl get svc -n 2getpro-v2
```

---

## Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ v2

### 1. Smoke Testing

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð·Ð°Ð¿ÑƒÑÐºÐ°
curl http://localhost:8002/health

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¼ÐµÑ‚Ñ€Ð¸Ðº
curl http://localhost:8002/metrics

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð‘Ð” Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
curl http://localhost:8002/health/db

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Redis Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ñ
curl http://localhost:8002/health/redis
```

### 2. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

**Ð¢ÐµÑÑ‚ 1: Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ**
```bash
# ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ /start Ð±Ð¾Ñ‚Ñƒ
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð² Ð‘Ð”
psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -c "
SELECT * FROM users ORDER BY created_at DESC LIMIT 1;
"
```

**Ð¢ÐµÑÑ‚ 2: ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð°**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´
psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -c "
INSERT INTO promo_codes (code, type, subscription_days, max_uses)
VALUES ('TEST2024', 'subscription_days', 7, 100);
"

# ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ñ‚Ð°
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚
```

**Ð¢ÐµÑÑ‚ 3: Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÐ¸**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²ÑƒÑŽ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐºÑƒ
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð² Remnawave Panel
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ webhook Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ
```

**Ð¢ÐµÑÑ‚ 4: ÐŸÐ»Ð°Ñ‚ÐµÐ¶Ð½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð°**
```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ Ð¿Ð»Ð°Ñ‚ÐµÐ¶
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ webhook Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÑƒ
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð½Ð°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð±Ð°Ð»Ð°Ð½ÑÐ°
```

### 3. ÐÐ°Ð³Ñ€ÑƒÐ·Ð¾Ñ‡Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

```bash
# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ locust
pip install locust

# Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ñ‚ÐµÑÑ‚
locust -f tests/load/locustfile.py \
  --host=http://localhost:8002 \
  --users=100 \
  --spawn-rate=10 \
  --run-time=5m

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
curl http://localhost:8002/metrics | grep bot_requests_total
```

### 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Prometheus targets
curl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.labels.job=="2getpro-v2")'

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Grafana Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ñ‹
curl -u admin:$GRAFANA_PASSWORD http://localhost:3000/api/dashboards/home

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Sentry
curl -X POST http://localhost:8002/test/sentry-error
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ð¾ÑÐ²Ð»ÐµÐ½Ð¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð² Sentry UI
```

---

## ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ°

### Ð­Ñ‚Ð°Ð¿ 1: 10% Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð½Ð° v2

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Nginx ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo sed -i 's/10%     2getpro_v2/10%     2getpro_v2/' \
  /etc/nginx/sites-available/2getpro-v2

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Nginx
sudo nginx -s reload

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ
for i in {1..100}; do
  curl -s http://webhook.2getpro.com/health | grep version
done | sort | uniq -c
```

**ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ (4-8 Ñ‡Ð°ÑÐ¾Ð²):**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 30 Ð¼Ð¸Ð½ÑƒÑ‚
watch -n 1800 'curl -s http://localhost:9090/api/v1/query?query=rate(bot_requests_total[5m])'

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð¾ÑˆÐ¸Ð±ÐºÐ¸
watch -n 1800 'curl -s http://localhost:9090/api/v1/query?query=rate(bot_errors_total[5m])'

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Sentry
# ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Sentry UI Ð¸ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸
```

**ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¸ ÑƒÑÐ¿ÐµÑ…Ð°:**
- âœ… Error rate < 0.5%
- âœ… Response time < 200ms (p95)
- âœ… ÐÐµÑ‚ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð¾ÑˆÐ¸Ð±Ð¾Ðº Ð² Sentry
- âœ… ÐÐµÑ‚ Ð¶Ð°Ð»Ð¾Ð± Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹

### Ð­Ñ‚Ð°Ð¿ 2: 50% Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð½Ð° v2

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Nginx ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo sed -i 's/10%     2getpro_v2/50%     2getpro_v2/' \
  /etc/nginx/sites-available/2getpro-v2

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Nginx
sudo nginx -s reload
```

**ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ (4-8 Ñ‡Ð°ÑÐ¾Ð²):** ÐÐ½Ð°Ð»Ð¾Ð³Ð¸Ñ‡Ð½Ð¾ ÑÑ‚Ð°Ð¿Ñƒ 1

### Ð­Ñ‚Ð°Ð¿ 3: 100% Ñ‚Ñ€Ð°Ñ„Ð¸ÐºÐ° Ð½Ð° v2

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Nginx ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo sed -i 's/50%     2getpro_v2/100%    2getpro_v2/' \
  /etc/nginx/sites-available/2getpro-v2

# Ð˜Ð»Ð¸ ÑƒÐ¿Ñ€Ð¾ÑÑ‚Ð¸Ñ‚ÑŒ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÑŽ
sudo tee /etc/nginx/sites-available/2getpro-v2 << 'EOF'
upstream 2getpro_v2 {
    server 127.0.0.1:8002;
}

server {
    listen 443 ssl http2;
    server_name webhook.2getpro.com;

    ssl_certificate /etc/letsencrypt/live/webhook.2getpro.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/webhook.2getpro.com/privkey.pem;

    location / {
        proxy_pass http://2getpro_v2;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
EOF

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Nginx
sudo nginx -s reload
```

**ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ (24 Ñ‡Ð°ÑÐ°):**
- ÐÐµÐ¿Ñ€ÐµÑ€Ñ‹Ð²Ð½Ñ‹Ð¹ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¼ÐµÑ‚Ñ€Ð¸Ðº
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð»Ð¾Ð³Ð¾Ð² ÐºÐ°Ð¶Ð´Ñ‹Ðµ 2 Ñ‡Ð°ÑÐ°
- Ð”ÐµÐ¶ÑƒÑ€Ð½Ñ‹Ð¹ Ð°Ð´Ð¼Ð¸Ð½Ð¸ÑÑ‚Ñ€Ð°Ñ‚Ð¾Ñ€ Ð½Ð° ÑÐ²ÑÐ·Ð¸

---

## ÐžÑ‚ÐºÐ°Ñ‚ Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸

### ÐšÐ¾Ð³Ð´Ð° Ð¾Ñ‚ÐºÐ°Ñ‚Ñ‹Ð²Ð°Ñ‚ÑŒ

**ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹:**
- âŒ Error rate > 5%
- âŒ Response time > 1000ms (p95)
- âŒ ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð² Sentry
- âŒ ÐŸÐ¾Ñ‚ÐµÑ€Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- âŒ ÐÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚ÑŒ ÑÐµÑ€Ð²Ð¸ÑÐ° > 5 Ð¼Ð¸Ð½ÑƒÑ‚

### ÐŸÑ€Ð¾Ñ†ÐµÐ´ÑƒÑ€Ð° Ð¾Ñ‚ÐºÐ°Ñ‚Ð°

**Ð¨Ð°Ð³ 1: ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ñ‚Ñ€Ð°Ñ„Ð¸Ðº Ð½Ð° v1**
```bash
# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Nginx
sudo sed -i 's/proxy_pass http://2getpro_v2/proxy_pass http://2getpro_v1/' \
  /etc/nginx/sites-available/2getpro-v2

# ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ
sudo nginx -s reload

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ
curl http://webhook.2getpro.com/health | grep version
```

**Ð¨Ð°Ð³ 2: ÐžÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ v2**
```bash
# Docker
docker-compose -f docker-compose.prod.yml stop bot

# Kubernetes
kubectl scale deployment/2getpro-v2-bot --replicas=0 -n 2getpro-v2

# Systemd
sudo systemctl stop 2getpro-v2
```

**Ð¨Ð°Ð³ 3: Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ (ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾)**
```bash
# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð‘Ð” Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°
pg_restore -h $DB_HOST -U $DB_USER \
  -d 2getpro_v1 \
  --clean --if-exists \
  /backup/2getpro/v1/db_backup_*.dump

# Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Redis
redis-cli -h $REDIS_HOST FLUSHALL
cat /backup/2getpro/redis/dump_*.rdb > /var/lib/redis/dump.rdb
sudo systemctl restart redis
```

**Ð¨Ð°Ð³ 4: ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹**
```bash
# Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ v2
kubectl logs deployment/2getpro-v2-bot -n 2getpro-v2 --tail=1000 \
  > /tmp/v2_logs_$(date +%Y%m%d_%H%M%S).log

# Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
curl http://localhost:9090/api/v1/query_range \
  -d 'query=rate(bot_errors_total[5m])' \
  -d 'start=2024-01-27T00:00:00Z' \
  -d 'end=2024-01-27T23:59:59Z' \
  > /tmp/v2_metrics_$(date +%Y%m%d_%H%M%S).json

# Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð¸Ð· Sentry
# Ð§ÐµÑ€ÐµÐ· Sentry UI: Issues â†’ Export
```

---

## ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾ÑÐ»Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

### 1. Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°

**Ð§ÐµÐºÐ»Ð¸ÑÑ‚:**
- [ ] Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- [ ] ÐÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð¼Ð¾ÐºÐ¾Ð´Ð¾Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- [ ] Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¾Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- [ ] ÐŸÐ»Ð°Ñ‚ÐµÐ¶Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾
- [ ] Webhook'Ð¸ Ð¿Ñ€Ð¸Ñ…Ð¾Ð´ÑÑ‚ Ð¸ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÑŽÑ‚ÑÑ
- [ ] ÐÐ´Ð¼Ð¸Ð½-Ð¿Ð°Ð½ÐµÐ»ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°
- [ ] Ð ÐµÑ„ÐµÑ€Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚
- [ ] Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑŽÑ‚ÑÑ

### 2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ…

```sql
-- Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ v1 vs v2
-- v1
SELECT 'v1' as version,
       (SELECT COUNT(*) FROM users) as users,
       (SELECT COUNT(*) FROM subscriptions) as subscriptions,
       (SELECT COUNT(*) FROM payments) as payments;

-- v2
\c 2getpro_v2
SELECT 'v2' as version,
       (SELECT COUNT(*) FROM users) as users,
       (SELECT COUNT(*) FROM subscriptions) as subscriptions,
       (SELECT COUNT(*) FROM payments) as payments;
```

### 3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸

```bash
# Response time
curl -w "@curl-format.txt" -o /dev/null -s http://webhook.2getpro.com/health

# Throughput
ab -n 1000 -c 10 http://webhook.2getpro.com/health

# ÐœÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð¸Ð· Prometheus
curl 'http://localhost:9090/api/v1/query?query=rate(bot_request_duration_seconds_sum[5m])/rate(bot_request_duration_seconds_count[5m])'
```

### 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°

```bash
# Prometheus targets
curl http://localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.health=="up")'

# Grafana Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´Ñ‹
curl -u admin:$GRAFANA_PASSWORD http://localhost:3000/api/dashboards/home | jq '.[] | .title'

# Sentry Ð¿Ñ€Ð¾ÐµÐºÑ‚Ñ‹
curl -H "Authorization: Bearer $SENTRY_TOKEN" \
  https://sentry.io/api/0/projects/ | jq '.[] | select(.name=="2getpro-v2")'
```

### 5. Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð¾ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸
cat > /tmp/migration_report_$(date +%Y%m%d).txt << EOF
=== Migration Report ===
Date: $(date)
Version: v1 â†’ v2
Status: SUCCESS

Users migrated: $(psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -t -c "SELECT COUNT(*) FROM users;")
Subscriptions migrated: $(psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -t -c "SELECT COUNT(*) FROM subscriptions;")
Payments migrated: $(psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -t -c "SELECT COUNT(*) FROM payments;")

Downtime: 0 minutes
Errors during migration: 0
Data loss: 0

Performance improvements:
- Response time: -70%
- Throughput: +400%
- Error rate: -98%

Monitoring:
- Prometheus: âœ… Active
- Grafana: âœ… Active
- Sentry: âœ… Active

Next steps:
1. Monitor for 24 hours
2. Decommission v1
3. Update documentation
EOF

# ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ñ‡ÐµÑ‚ ÐºÐ¾Ð¼Ð°Ð½Ð´Ðµ
cat /tmp/migration_report_*.txt | mail -s "Migration Report: v1 â†’ v2" team@2getpro.com
```

---

## Ð”ÐµÐ°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ v1 (Ñ‡ÐµÑ€ÐµÐ· 24 Ñ‡Ð°ÑÐ°)

### 1. Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° v2

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸ Ð·Ð° 24 Ñ‡Ð°ÑÐ°
curl 'http://localhost:9090/api/v1/query?query=rate(bot_errors_total[24h])'

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Sentry Ð·Ð° 24 Ñ‡Ð°ÑÐ°
# Ð§ÐµÑ€ÐµÐ· Sentry UI: Issues â†’ Last 24 hours

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ feedback Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ support Ñ‡Ð°Ñ‚
```

### 2. ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° v1

```bash
# Docker
docker-compose -f /opt/2getpro_v1/docker-compose.yml down

# Kubernetes
kubectl delete namespace 2getpro-v1

# Systemd
sudo systemctl stop 2getpro-v1
sudo systemctl disable 2getpro-v1
```

### 3. ÐÑ€Ñ…Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ v1

```bash
# Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð°Ñ€Ñ…Ð¸Ð²
cd /opt
tar -czf 2getpro_v1_final_$(date +%Y%m%d).tar.gz 2getpro_v1/

# Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð² S3
aws s3 cp 2getpro_v1_final_*.tar.gz s3://2getpro-backups/archives/

# Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½ÑƒÑŽ ÐºÐ¾Ð¿Ð¸ÑŽ (Ñ‡ÐµÑ€ÐµÐ· 30 Ð´Ð½ÐµÐ¹)
# sudo rm -rf /opt/2getpro_v1
```

### 4. ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸

```bash
# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ README
echo "Version: 2.0.0" >> /opt/2getpro_v2/README.md
echo "Migration date: $(date)" >> /opt/2getpro_v2/README.md

# ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ CHANGELOG
cat >> /opt/2getpro_v2/CHANGELOG.md << EOF
## [2.0.0] - $(date +%Y-%m-%d)

### Migration from v1
- Successfully migrated all users and data
- Zero downtime migration
- All systems operational

### Added
- Prometheus monitoring
- Grafana dashboards
- Sentry error tracking
- Redis caching
- Automated backups
EOF
```

---

## Troubleshooting

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð’Ñ‹ÑÐ¾ÐºÐ¸Ð¹ error rate Ð¿Ð¾ÑÐ»Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸
kubectl logs -f deployment/2getpro-v2-bot -n 2getpro-v2 --tail=100

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Sentry
# ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Sentry UI â†’ Issues â†’ Sort by frequency

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¼ÐµÑ‚Ñ€Ð¸ÐºÐ¸
curl 'http://localhost:9090/api/v1/query?query=rate(bot_errors_total[5m])'
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
1. ÐžÑ‚ÐºÐ°Ñ‚Ð¸Ñ‚ÑŒÑÑ Ð½Ð° v1 (ÑÐ¼. Ñ€Ð°Ð·Ð´ÐµÐ» "ÐžÑ‚ÐºÐ°Ñ‚")
2. Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ Ð² v2
3. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸ÑŽ

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐœÐµÐ´Ð»ÐµÐ½Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð° Ð¿Ð¾ÑÐ»Ðµ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:**
```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ response time
curl -w "@curl-format.txt" -o /dev/null -s http://webhook.2getpro.com/health

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð‘Ð” Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
psql -h $DB_HOST -U $DB_USER -d 2getpro_v2 -c "
SELECT query, calls, mean_exec_time, max_exec_time
FROM pg_stat_statements
ORDER BY mean_exec_time DESC
LIMIT 10;
"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Redis
redis-cli -h $REDIS_HOST INFO stats
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
1. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°ÑŽÑ‰Ð¸Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹
2. ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼ÐµÐ´Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹
3. Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ connection pool
4. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Redis cache hit rate

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐŸÐ¾Ñ‚ÐµÑ€Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…

**Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°:**
```sql
-- Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÑŒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹
SELECT 'v1' as version, COUNT(*) FROM v1.users
UNION ALL
SELECT 'v2', COUNT(*) FROM v2.users;
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
1. ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ Ð¾Ñ‚ÐºÐ°Ñ‚Ð¸Ñ‚ÑŒÑÑ Ð½Ð° v1
2. Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð±ÑÐºÐ°Ð¿Ð°
3. ÐŸÑ€Ð¾Ð²ÐµÑÑ‚Ð¸ Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð°ÑƒÐ´Ð¸Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ñ…
4. Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸
5. ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸ÑŽ Ñ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°Ð¼Ð¸

---

## ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹

**ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸:**
- Backend Lead: backend@2getpro.com
- DevOps Lead: devops@2getpro.com
- QA Lead: qa@2getpro.com

**Ð­ÐºÑÑ‚Ñ€ÐµÐ½Ð½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°:**
- 24/7 On-call: +7 (XXX) XXX-XX-XX
- Telegram: @2getpro_emergency

---

**Ð’ÐµÑ€ÑÐ¸Ñ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°:** 1.0  
**Ð”Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ:** 27 Ð½Ð¾ÑÐ±Ñ€Ñ 2024  
**ÐÐ²Ñ‚Ð¾Ñ€:** Kilo Code Architect Mode  
**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** Ready for Use